<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>DAND6 JSDoc Source: AppExploreController.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.paper.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html"><img class="branding-logo" src="../images/dand6_coldbat_tiny.png"
		alt="logo"/>DAND6 JSDoc</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu inline">
					<li><a href="module-AppChart.html">AppChart</a></li><li><a href="module-AppChartController.html">AppChartController</a></li><li><a href="module-AppChartPanel.html">AppChartPanel</a></li><li><a href="module-AppConfigurator.html">AppConfigurator</a></li><li><a href="module-AppConstants.html">AppConstants</a></li><li><a href="module-AppDropdownDirective.html">AppDropdownDirective</a></li><li><a href="module-AppExplainController.html">AppExplainController</a></li><li><a href="module-AppHelper.html">AppHelper</a></li><li><a href="module-AppMainController.html">AppMainController</a></li><li><a href="module-AppMetricDirective.html">AppMetricDirective</a></li><li><a href="module-AppMetricsDirective.html">AppMetricsDirective</a></li><li><a href="module-AppRoutesDirective.html">AppRoutesDirective</a></li><li><a href="module-AppSchematicsDirective.html">AppSchematicsDirective</a></li><li><a href="module-AppSeriesDirective.html">AppSeriesDirective</a></li><li><a href="module-AppStoriesDirectives.html">AppStoriesDirectives</a></li><li><a href="module-AppTranscopeDirective.html">AppTranscopeDirective</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu inline">
					<li><a href="module-AppChartController-AppChartController.html">AppChartController~AppChartController</a></li><li><a href="module-AppChartPanel-AppSummaryDirective.html">AppChartPanel~AppSummaryDirective</a></li><li><a href="module-AppChart-AppChart.html">AppChart~AppChart</a></li><li><a href="module-AppChart-AppGraphStrategy.html">AppChart~AppGraphStrategy</a></li><li><a href="module-AppChart-AppLineGraph.html">AppChart~AppLineGraph</a></li><li><a href="module-AppChart-AppScatterGraph.html">AppChart~AppScatterGraph</a></li><li><a href="module-AppConfigurator-AppConfigurator.html">AppConfigurator~AppConfigurator</a></li><li><a href="module-AppDropdownDirective-AppDropdownController.html">AppDropdownDirective~AppDropdownController</a></li><li><a href="module-AppDropdownDirective-AppDropdownDirective.html">AppDropdownDirective~AppDropdownDirective</a></li><li><a href="module-AppExplainController-AppExplainController.html">AppExplainController~AppExplainController</a></li><li><a href="module-AppExplainController-AppExploreController.html">AppExplainController~AppExploreController</a></li><li><a href="module-AppHelper-AppHelper.html">AppHelper~AppHelper</a></li><li><a href="module-AppMainController-AppMainController.html">AppMainController~AppMainController</a></li><li><a href="module-AppMetricDirective-AppMetricController.html">AppMetricDirective~AppMetricController</a></li><li><a href="module-AppMetricDirective-AppMetricDirective.html">AppMetricDirective~AppMetricDirective</a></li><li><a href="module-AppMetricsDirective-AppMetricsController.html">AppMetricsDirective~AppMetricsController</a></li><li><a href="module-AppMetricsDirective-AppMetricsDirective.html">AppMetricsDirective~AppMetricsDirective</a></li><li><a href="module-AppRoutesDirective-AppRoutesController.html">AppRoutesDirective~AppRoutesController</a></li><li><a href="module-AppRoutesDirective-AppRoutesDirective.html">AppRoutesDirective~AppRoutesDirective</a></li><li><a href="module-AppSchematicsDirective-AppSchematicsController.html">AppSchematicsDirective~AppSchematicsController</a></li><li><a href="module-AppSchematicsDirective-AppSchematicsDirective.html">AppSchematicsDirective~AppSchematicsDirective</a></li><li><a href="module-AppSeriesDirective-AppSeriesClassManipulator.html">AppSeriesDirective~AppSeriesClassManipulator</a></li><li><a href="module-AppSeriesDirective-AppSeriesColorManipulator.html">AppSeriesDirective~AppSeriesColorManipulator</a></li><li><a href="module-AppSeriesDirective-AppSeriesController.html">AppSeriesDirective~AppSeriesController</a></li><li><a href="module-AppSeriesDirective-AppSeriesDimensionManipulator.html">AppSeriesDirective~AppSeriesDimensionManipulator</a></li><li><a href="module-AppSeriesDirective-AppSeriesDirective.html">AppSeriesDirective~AppSeriesDirective</a></li><li><a href="module-AppSeriesDirective-AppSeriesManipulator.html">AppSeriesDirective~AppSeriesManipulator</a></li><li><a href="module-AppSeriesDirective-AppSeriesTextManipulator.html">AppSeriesDirective~AppSeriesTextManipulator</a></li><li><a href="module-AppStoriesDirectives-AppStoriesController.html">AppStoriesDirectives~AppStoriesController</a></li><li><a href="module-AppStoriesDirectives-AppStoriesDirective.html">AppStoriesDirectives~AppStoriesDirective</a></li><li><a href="module-AppTranscopeDirective-AppTranscopeDirective.html">AppTranscopeDirective~AppTranscopeDirective</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu inline">
					<li><a href="tutorial-1FileDirectoryStructure.html">File & Directory Structure</a></li><li><a href="tutorial-2Terminology.html">Terminology</a></li><li><a href="tutorial-3JSONDataStructure.html">JSON Class Structure of Data Files</a></li><li><a href="tutorial-4Components.html">Components of the Application</a></li><li><a href="tutorial-5ComponentsInteraction.html">Interaction of the Components</a></li><li><a href="tutorial-6LayersAppChart.html">Layers in the AppChart D3.js Graph</a></li>
				</ul>
			</li>
			
		</ul>
		<div class="col-sm-3 col-md-3">
            <form class="navbar-form" role="search">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                    <div class="input-group-btn">
                        <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
            </form>
        </div>
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: AppExploreController.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">/**
 * Exposes an AngularJS controller to retrieve the data for the exploratory
 * visualization and manage the interactive state of the visualization.
 * @module AppExplainController
 * @exports AppExplainController
 */
define(["AppConstants"], function(AppConstants) {

  /**
   * The controller retrieving the data for the exploratory visualization and
   * governing the interaction on this visualization.
   * @constructor
   */
  AppExploreController = function($scope, $http, $location) {
    // memorize $http and $location service
    this.$http = $http;
    this.$location = $location;
    // currently, we have no scenarios loaded and not scenarios selected
    this.scenarios = [];
    this.selectedScenario = undefined;
    this.dataDir = AppConstants.DATA_DIR;
    this.scenariosFile = AppConstants.SCENARIOS_FILE;
    // react everytime the selected scenarios, metrics or stories changed
    $scope.$watch("appExplore.selectedScenario",
        this.selectedScenarioChangedHandler());
    $scope.$watch("appExplore.selectedMetrics",
        this.selectedMetricsChangedHandler(), true); // needs deep comparison
    $scope.$watch("appExplore.selectedStory",
        this.selectedStoryChangedHandler());
    // react every time the URL search string changed
    $scope.$on("$locationChangeSuccess", this.processUrlHandler());
    // reset highlights: currently nothing is highlighted
    this.resetHighlights();
    // load scenarios
    this.loadScenarios(this.dataDir + "/" + this.scenariosFile);
  };

  /**
   * Factory to create the directive; used in the angular.directive call.
   * @static
   */
  AppExploreController.factory = function($scope, $http, $location) {
    return new AppExploreController($scope, $http, $location);
  };

  /**
   * Loads the scenario file containing all the selectable scenarios from a URL
   * supplied to the function.
   * @param scenarioUrl the URL to load the scenarios file from
   */
  AppExploreController.prototype.loadScenarios = function(scenarioUrl) {
    this.$http.get(scenarioUrl).success(this.scenariosLoadedHandler());
  };

  /**
   * Loads a metrics file containing the metrics data from a URL
   * supplied to the function.
   * @param metricsUrl the URL to load the metrics file from
   */
  AppExploreController.prototype.loadMetrics = function(metricsUrl) {
    this.resetHighlights();
    this.$http.get(metricsUrl).success(this.metricsLoadedHandler());
  };

  /**
   * Loads a stories file containing the stories from a URL
   * supplied to the function.
   * @param storiesUrl the URL to load the stories file from
   */
  AppExploreController.prototype.loadStories = function(storiesUrl) {
    this.$http.get(storiesUrl).success(this.storiesLoadedHandler());
  };

  /**
   * Resets all "highlights" back to normal, that means, no part of the
   * visualization will be highlighted/marked/zoomed-in etc. after calling this
   * method.
   */
  AppExploreController.prototype.resetHighlights = function() {
    if (!this.highlights) this.highlights = {};
    this.highlights.seriesId = undefined;
    this.highlights.metric = undefined;
    this.highlights.x = undefined;
    this.highlights.xRange = [undefined, undefined];
    this.highlights.looseness = 0;
    this.highlights.seriesesValues = {};
  };

  /**
   * Helper function to select a number of metrics from the loaded metrics
   * by its 'id' property. Can be used, e.g., if a storybox needs to display
   * certain metric graphs based on the story's 'metrics' property.
   * @param metricsIds an array of metric ids
   */
  AppExploreController.prototype.selectMetricsById = function(metricsIds) {
    this.selectedMetrics = [];
    for (i in this.metrics) {
      if (metricsIds.indexOf(this.metrics[i].id) != -1)
        this.selectedMetrics.push(this.metrics[i])
    }
  };

  /**
   * Returns a callback to be invoked with the JSON data as parameter after a
   * metrics JSON file is loaded.
   */
  AppExploreController.prototype.metricsLoadedHandler = function() {
    var self = this;
    return function(data) {
      self.metrics = data;
      // load stories, if stories are associated with this scenario
      if (self.selectedScenario.storiesFile)
        self.loadStories(self.dataDir + "/" +
            self.selectedScenario.storiesFile);
    };
  };

  /**
   * Returns a callback to be invoked with the JSON data as parameter after a
   * stories JSON file is loaded.
   */
  AppExploreController.prototype.storiesLoadedHandler = function() {
    var self = this;
    return function(data) {
      self.stories = data;
      if (data.length > 0) {
        self.selectedStory = data[0];
        self.highlights.looseness = 0;
      }
      self.processUrlStoryId();
    };
  };

  /**
   * Returns a callback to be invoked with the JSON data as parameter after the
   * scenarios JSON file is loaded.
   */
  AppExploreController.prototype.scenariosLoadedHandler = function() {
    var self = this;
    return function(data) {
      self.scenarios = data;
      self.processUrlScenarioId();
    };
  };

  /**
   * Returns a callback that should be invoked every time the user changes the
   * selected scenario. The callback updates the URL's search string and loads
   * all metrics associated with the scenario.
   */
  AppExploreController.prototype.selectedScenarioChangedHandler = function() {
    var self = this;
    return function() {
      // reset metrics and stories
      self.metrics = undefined;
      self.stories = undefined;
      self.selectedMetrics = [];
      self.serieses = [];
      // reset highlights
      self.resetHighlights();
      // if we actually do have a scenario selected
      if (self.selectedScenario !== undefined) {
        // ... update the URL's search string
        self.$location.search("scenarioId", self.selectedScenario.id);
        // load metrics
        self.loadMetrics(self.dataDir + "/" + self.selectedScenario.dataFile);
      }
    };
  };

  /**
   * Returns a callback that should be invoked every time the user changes the
   * selected story. The callback updates the URL's search string to contain
   * a reference to that story.
   */
  AppExploreController.prototype.selectedStoryChangedHandler = function() {
    var self = this;
    return function() {
      if (self.selectedStory !== undefined)
        self.$location.search("storyId", self.selectedStory.id);
    }
  };

  /**
   * Returns a callback that should be invoked every time the user changes the
   * selected metrics. The callback updates an internal array "serieses"
   * that contains all the serieses of all the metrics.
   */
  AppExploreController.prototype.selectedMetricsChangedHandler = function() {
    var self = this;
    return function() {
      self.serieses = [];
      for (i in self.selectedMetrics)
        for (j in self.selectedMetrics[i].serieses)
          self.serieses.push(self.selectedMetrics[i].serieses[j])
    }
  };

  /**
   * Returns a callback that should be invoked every time the URL's search
   * string changes. The callback processes the URL-parameters 'scenarioId' and
   * 'storyId'.
   * @see module:AppExploreController~AppExploreController#processUrlScenarioId
   * @see module:AppExploreController~AppExploreController#processUrlStoryId
   */
  AppExploreController.prototype.processUrlHandler = function() {
    var self = this;
    return function($event, $args) {
      self.processUrlScenarioId();
      self.processUrlStoryId();
    }
  };

  /**
   * Updates the selected scenario based on the URL's search parameter
   * 'scenarioId'.
   */
  AppExploreController.prototype.processUrlScenarioId = function() {
    var scenarioId = this.$location.search().scenarioId,
        scenario = undefined;
    for (i in this.scenarios)
      if (this.scenarios[i].id == scenarioId)
        scenario = this.scenarios[i];
    this.selectedScenario = scenario;
  };

  /**
   * Updates the selected story based on the URL's search parameter 'storyId'.
   */
  AppExploreController.prototype.processUrlStoryId = function() {
    var storyId = this.$location.search().storyId,
        story = undefined;
    if (this.stories &amp;&amp; this.stories.length > 0) {
      for (i in this.stories)
        if (this.stories[i].id == storyId)
          story = this.stories[i];
      if (story === undefined &amp;&amp; this.selectedStory === undefined)
        this.selectedStory = this.stories[0];
    }
  };

  return AppExploreController;

});
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>

<div class="modal fade" id="searchResults">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Search results</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>

<footer>


	<span class="copyright">
	&copy; 2016 benkku.com
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a>
	
		on Thu May 26th 2016
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>
<script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>

<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			var id = $( heading ).attr( "id" );
			return id && id.replace(/\~/g, '-inner-').replace(/\./g, '-static-') || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->


<script type="text/javascript">
	$(document).ready(function() {
		SearcherDisplay.init();
	});
</script>

</body>
</html>
